# -- coding: utf-8 --
"""
Created on 13.04.2019
Tkinter ile GUI  işlemleri
@author: yagizzk @author: iyasinates
"""
import tkinter
from tkinter import *
from tkinter import ttk
from tkinter import messagebox
import os
import sys
import urllib
import subprocess
import webbrowser
import tkinter as tk
############################### aktif bilgi toplama ########################################

def nslookup():
    top7 = tkinter.Tk()
    top7.geometry('660x480')
    top7.title("Site IP Adresi Tarama -nslookup-")
    t = tk.Text(top7, height=20, width=50)
    t.place(x=30, y=95)

    s = tk.Scrollbar(top7)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    def nslookupPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["nslookup", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        start = output.find("Name:")
        output = output[start:]
        #sonuc = Label(top7,text=output)
        #sonuc.pack()
        t.insert(tk.END, output)

        return output

    LabelBilgi=Label(top7, text="Nslookup domain ip aralığını araştırır.Yürütülen Kod: nslookup www.example.com" ,font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top7, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top7)
    mEntry.place(x=155, y=50)
    mbutton = Button(top7, text="Bul", command=nslookupPlay ,font=('Titillium', '10','bold'))
    mbutton.place(x=305, y=45)

def urlcrazy():
    top9 = tkinter.Tk()
    top9.geometry('1100x450')
    top9.title("Benzer Domain Tarama -urlcrazy-")

    t = tk.Text(top9, height=20, width=130)
    t.place(x=30, y=95)

    s = tk.Scrollbar(top9)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def urlcrazyPlau():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["urlcrazy", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output, 'utf-8')

        start = output.find("hostnames") - 4
        # finish= output.find("")-2
        output = output[start:]


        t.insert(tk.END, output)



        return output


    LabelBilgi=Label(top9, text="URLcrazy aracı hedef domaine benzer domainleri ve kullanım durumlarını listeler. urlcrazy www.example.com",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top9, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top9)
    mEntry.place(x=155, y=50)

    buttonn = Button(top9, text="Listele", command=urlcrazyPlau ,font=('Titillium', '10','bold'))
    buttonn.place(x=305, y=45)

def whatweb():
    top11 = tkinter.Tk()
    top11.geometry('700x400')
    top11.title("whatweb")
    t = tk.Text(top11, height=20, width=130)
    t.place(x=30, y=95)

    s = tk.Scrollbar(top11)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    # bütün sonuc tek satır dönüyor onu \n le güzeltmek lazım ve yazı çok kötü kullanilmicak derecede
    def WhatwebPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["whatweb", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output, 'utf-8')
        # start = output.find(address)-address.length()
        # finish= output.find("Trying")
        # output = output[start:finish]
        #sonuc = Label(top11,text=output)
        #sonuc.pack()

        t.insert(tk.END, output)
        #print(type(output))
        #print(output)
        return output

    LabelBilgi = Label(top11, text="Hedef sitenin script adı ve sürümü hakkında bilgi verir.whatweb www.example.com",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top11, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top11)
    mEntry.place(x=130, y=50)
    mbutton = Button(top11, text="Script Bilgisi Al", command=WhatwebPlay,font=('Titillium', '10','bold'))
    mbutton.place(x=300, y=45)

def dnsenum():
    # yazılar biraz sorunlu
    top12 = tkinter.Tk()
    top12.geometry('800x450')
    top12.title("Hedef Site / Sunucu DNS Bilgi Toplama -dnsenum-")
    t = tk.Text(top12, height=20, width=90)
    t.place(x=30, y=95)

    s = tk.Scrollbar(top12)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def dnsenumPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["dnsenum", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output, 'utf-8')
        start = output.find("---")
        finish = output.find("Trying")
        output = output[start:finish]
        #sonuc = Label(top12, text=output)
        #sonuc.pack()

        t.insert(tk.END, output)

        return output

    LabelBilgi = Label(top12, text="Hedef sunucu veya site dnsleri hakkında bilgi verir.dnsenum www.example.com",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top12, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top12)
    mEntry.place(x=155, y=50)
    mbutton = Button(top12, text="Bilgi Al", command=dnsenumPlay,font=('Titillium', '10','bold'))
    mbutton.place(x=305, y=45)

def fierce():
    top13 = tkinter.Tk()
    top13.geometry('700x400')
    top13.title("Hedef Site / Sunucu Version Bilgisi")

    t = tk.Text(top13, height=20, width=50)
    t.place(x=30, y=95)

    s = tk.Scrollbar(top13)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def fiercePlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["fierce", "-version", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output, 'utf-8')
        # start = output.find(address)-address.length()
        finish = output.find("Exit")
        output = output[:finish]
        #sonuc = Label(top13, text=output)
        #sonuc.pack()

        t.insert(tk.END, output)

        return output

    abelBilgi = Label(top13,text="Sitenin versiyon numarasini verir.fierce -version www.example.com",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top13, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top13)
    mEntry.place(x=130, y=50)
    mbutton = Button(top13, text="Versiyon Bilgisi Al", command=fiercePlay,font=('Titillium', '10','bold'))
    mbutton.place(x=300, y=45)

def dmitry():
    top6  = tkinter.Tk()
    top6.geometry('800x500')
    top6.title("Site Açık Port / Whois Bilgileri Tarama -dmitry-")

    t = tk.Text(top6, height=20, width=90)
    t.place(x=30, y=145)

    s = tk.Scrollbar(top6)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def dmitryPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        temp = ComboboxEntry.get()
        temp = temp[4:6]
        print(temp)
        print(address)
        terminalcode = subprocess.Popen(["dmitry",temp,address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        #start = output.find("")
        #finish= output.find("This query")-2
        #output = output[:finish]
        #sonuc = Label(top6,text=output)
        #sonuc.pack()

        t.insert(tk.END, output)

        return output

    LabelBilgi = Label(top6,text="dmitry -param www.exeample.com",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top6, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    ComboboxLabel = Label(top6, text="Tarama Tipi Sec:",font=('Titillium', '10','bold')).place(x=30, y=80)
    ComboboxEntry = ttk.Combobox(top6, width=22)
    ComboboxEntry['values'] = ('1 | -i | Who is Bilgileri',
                               '2 | -p | Acik Port Tarama',
                               '3 | -n | Netcragt.com Bilgisi ',
                               '4 | -s | Subdomain Tarama',
                               '5 | -e | Email Tarama')
    ComboboxEntry.place(x=150, y=80)
    mEntry = Entry(top6)
    mEntry.place(x=150, y=50)

    mbutton = Button(top6, text="Site Hakkında Bilgi Al", command=dmitryPlay,font=('Titillium', '10','bold')).place(x=30, y=110)

#########################port ve servis taramaları ######################################

def ipSorgu():
    p = subprocess.Popen(["ifconfig"], stdout=subprocess.PIPE)
    output, err = p.communicate()
    output = str(output,'utf-8')
    dene = output.find("inet")+5
    dene2 = output.find("netmask")
    output = output[dene:dene2]
    return output

def nmapAg():
    top4 = tkinter.Tk()
    top4.title("Ağdaki Cihazları Tara")
    top4.geometry('460x400')
    t = tk.Text(top4, height=20, width=55)
    t.place(x = 30 , y=60)

    s = tk.Scrollbar(top4)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    def nmapPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        dottemp = 0
        sayac = 0
        output = ipSorgu()
        temp = output
        for i in range(0, len(temp)):
            if (temp[i] == "."):
                dottemp = dottemp + 1
            if (dottemp == 3):
                break
            sayac = sayac + 1
        netip = temp[0:sayac]
        netip += ".0/24"

        p = subprocess.Popen(["nmap", "-PR", netip], stdout=subprocess.PIPE)
        output, err = p.communicate()
        output = str(output, 'utf-8')
        start = output.find("256 IP addresses (")
        finish = output.find(" hosts up)")
        counter = output[start + 18:finish]
        a = 35
        for i in range(0, int(counter)):
            start1 = output.find("report for")
            finish1 = output.find("Host")
            ip = output[start1 + 10:finish1 - 2]

            start2 = output.find("MAC Address")
            finish2 = output.find("Nmap")
            macname = output[start2 + 12:finish2 - 2]
            output = output[finish1 + 1:]
            temp = i
            temp = str(temp)
            t.insert(tk.END,"IP \n")
            t.insert(tk.END, ip)
            t.insert(tk.END, "\n")

            t.insert(tk.END, "MACNAME\n")
            t.insert(tk.END, macname)
            t.insert(tk.END, "\n")



    mbutton = Button(top4, text="Cihazları Bul", command=nmapPlay,font=('Titillium', '10','bold'))
    mbutton.place(x = 170 , y=20)
    top4.mainloop()

def nmapCoklu():
    top14 = tkinter.Tk()
    top14.geometry('780x450')
    top14.title("Acik Port Tespiti -nmap-")
    t = tk.Text(top14, height=15, width=90)
    t.place(x = 30 , y=160)

    s = tk.Scrollbar(top14)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    def nmapCokluPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        temp = ComboboxEntry.get()
        temp2 = temp.find('|')
        temp = temp[2:temp2-1]
        temp3=""
        if(temp =="-sSU"):
            temp3 = "-O"

        if (temp == "-sS"):
            temp3="-sV"
        print(temp)
        print(temp3)

        terminalcode = subprocess.Popen(["nmap", temp,temp3, address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        print(type(output))
        output = str(output,'utf-8')

###############################################################################

        t.insert(tk.END, output)

################################################################################

        return output



    LabelBilgi = Label(top14,text="nmap -param www.example.com",font=('Titillium', '10','bold')).place(x=30,y=20)
    LabelGir = Label(top14, text="Site Adresi Gİrin:",font=('Titillium', '10','bold')).place(x=30,y=50)
    mEntry = Entry(top14)
    mEntry.place(x=160,y=50)


    ComboboxLabel = Label(top14, text="Tarama Tipi Sec:",font=('Titillium', '10','bold')).place(x=30,y=80)
    ComboboxEntry = ttk.Combobox(top14, width=34)
    ComboboxEntry['values'] = ('1 -PA | TCP-ACK Port Tarama',
                               '2 -sU | UDP-ACK Port Tarama',
			       '3 -sSU | İşletim Sistemi Tarama',
                               '4 -sS | Çalışan Servis Tarama',
                              )
    ComboboxEntry.place(x=160,y=80)

    mbutton = Button(top14, text="Tara", command=nmapCokluPlay,font=('Titillium', '10','bold'))
    mbutton.place(x=30,y=120)

    top14.mainloop()

def nmapfirewall():
    top22 = tkinter.Tk()
    top22.geometry('780x450')
    top22.title("Acik Port Tespiti -nmap-")
    tabControl3 = ttk.Notebook(top22)

    tab1 = ttk.Frame(tabControl3)
    tabControl3.add(tab1, text="Firewall Manuel Atlatma")

    tabControl3.pack(expan="1", fill="both")

    tab2 = ttk.Frame(tabControl3)
    tabControl3.add(tab2, text="Firewall Ek Paket ile Atlatma")


    t = tk.Text(tab1, height=15, width=90)
    t.place(x=30, y=160)

    s = tk.Scrollbar(tab1)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    t2 = tk.Text(tab2, height=15, width=90)
    t2.place(x=30, y=160)
    s2 = tk.Scrollbar(tab2)
    t2.config(yscrollcommand=s2.set)
    s2.pack(side=tk.RIGHT, fill=tk.Y)
    s2.config(command=t.yview)

    def mtuPlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        temp = ComboboxEntry.get()
        print(temp)
        terminalcode = subprocess.Popen(["nmap" ,"-mtu", temp, address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        print(type(output))
        output = str(output, 'utf-8')

        ###############################################################################

        t.insert(tk.END, output)

        ################################################################################

        return output


    def lengthPlay():
        t2.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry2.get()
        temp = temp2.get()
        print(temp)

        terminalcode = subprocess.Popen(["nmap", "--data-length", temp, address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        print(type(output))
        output = str(output, 'utf-8')

        ###############################################################################

        t2.insert(tk.END, output)

        ################################################################################

        return output

    ###############################     MTU    ################################################
    LabelBilgi = Label(tab1, text="nmap -mtu www.example.com", font=('Titillium', '10', 'bold')).place(x=30, y=20)
    LabelGir = Label(tab1, text="Site Adresi Gİrin: ", font=('Titillium', '10', 'bold')).place(x=30, y=50)
    mEntry = Entry(tab1)
    mEntry.place(x=160, y=50)

    ComboboxLabel = Label(tab1, text="8 ve Katı Bayt Seç: ", font=('Titillium', '10', 'bold')).place(x=30, y=80)
    ComboboxEntry = ttk.Combobox(tab1, width=10)
    ComboboxEntry['values'] = ('8',
                               '16',
                               '24',
                               '32',
                               '40',
                               )
    ComboboxEntry.place(x=160, y=80)

    mbutton = Button(tab1, text="Tara", command=mtuPlay, font=('Titillium', '10', 'bold'))
    mbutton.place(x=30, y=120)
    ###############################################################################

    ###############################################################################
    LabelBilgi2 = Label(tab2, text="nmap --data-length www.example.com", font=('Titillium', '10', 'bold')).place(x=30, y=20)
    LabelGir2 = Label(tab2, text="Site Adresi Gİrin: ", font=('Titillium', '10', 'bold')).place(x=30, y=50)
    mEntry2 = Entry(tab2)
    mEntry2.place(x=190, y=50)



    temp = Label(tab2, text="Ek Paket Miktarı(bayt): ", font=('Titillium', '10', 'bold')).place(x=30, y=80)
    temp2 = Entry(tab2)
    temp2.place(x=190, y=80)

    mbutton = Button(tab2, text="Tara", command=lengthPlay, font=('Titillium', '10', 'bold'))
    mbutton.place(x=30, y=120)
    ###############################################################################

############################### web güvenliği #############################################
def firewallControl():
    top2 = tkinter.Tk()
    top2.title("Güvenlik Duvarı Kontrol -wafw00f-")
    top2.geometry('790x380')
    t = tk.Text(top2, height=15, width=90)
    t.place(x = 30 , y=90)

    s = tk.Scrollbar(top2)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    def firewallControlPlay(ment):
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = ment
        terminalcode = subprocess.Popen(["wafw00f", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        start = output.find("Reason")
        if start != -1:
            finish = output.find("Number")
            output = output[start:finish]
        else:
            start = output.find("results:") + 8
            finish = output.find("Number")
            output = output[start:finish]
        #tag = Label(top2, text=output)
        #tag.pack()

        t.insert(tk.END, output)

        return output

    LabelBilgi = Label(top2, text="Sitenin güvenlik duvarı hakkında bilgi verir.wafw00f  www.example.com",font=('Titillium', '10','bold')).place(x=30,y=20)
    text = Label(top2, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30,y=50)

    mEntry2 = Entry(top2)
    mEntry2.place(x=155,y=50)

    mbutton = Button(top2, text="Guvenlik Duvari Kontrol Et",font=('Titillium', '10','bold'), command=lambda: firewallControlPlay(mEntry2.get() ))
    mbutton.place(x=305,y=45)

def skipfish():
    top19 = tkinter.Tk()
    top19.geometry('700x400')
    top19.title("Hedef Siteyi Detaylı Tara -skipfish-")

    def skipfishPlay():

        adres = mEntry.get()
        terminalcode = subprocess.Popen(["skipfish", "-o", "/root/Desktop/SkipFishTest", adres], stdout=subprocess.PIPE)  
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        # start = output.find("Host is up")
        # finish= output.find("This query")-2
        # output = output[start:]
        #sonuc = Label(text="Islem tamamlandı Masaüstüne bakın.")
        #sonuc.pack()

        labelframe = LabelFrame(top19, text="SONUCLAR")
        labelframe.place(x=130, y=150)

        left = Label(labelframe, text="İşlem tamamlandı. Masaüstüne sonuçlar kaydedildi.",font=('Titillium', '10','bold'))
        left.pack()

        mbutton = Button(labelframe, text="Sonuçları Gör",font=('Titillium', '10','bold'), command=lambda:webbrowser.open_new_tab("/root/Desktop/SkipFishTest/index.html")).pack()
        return output

    LabelBilgi = Label(top19, text="Skipfish siteyi detaylı tarayıp bulduğu açıkları /Desktop dizinine raporlar.\n Siteyi http://www.orneksite.com/ seklinde girmelisiniz. \nTarama +3dk sürmektedir.",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top19, text="Site girin:",font=('Titillium', '10','bold')).place(x=30, y=90)
    mEntry = Entry(top19)
    mEntry.place(x=130, y=90)

    mbutton = Button(top19, text="Siteyi Tara",font=('Titillium', '10','bold'), command=skipfishPlay)
    mbutton.place(x=300, y=88)

def uniscan():
    top20 = tkinter.Tk()
    top20.geometry('550x350')
    top20.title("Web Sitesi Tarama -uniscan-")

    def uniscanPlay():
        adres = mEntry.get()
        temp = ComboboxEntry.get()
        temp2 = temp.find('|')
        temp = temp[2:temp2-1]
        print(temp)

        terminalcode = subprocess.Popen(["uniscan","-u",adres,temp], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        #start = output.find("Host is up")
        #finish= output.find("This query")-2
        #output = output[start:]
        #sonuc = Label(top20, text="İşlem Tamamlandı.")
        #sonuc.pack()


        labelframe = LabelFrame(top20, text="SONUÇLAR",font=('Titillium', '10','bold'))
        labelframe.place(x=155, y=210)

        left = Label(labelframe, text="İşlem Tamamlandı.",font=('Titillium', '10','bold'))
        left.pack()
        mbutton = Button(labelframe, text="Sonuçları Gör",font=('Titillium', '10','bold'), command=lambda: webbrowser.open_new_tab("/usr/share/uniscan/report/" + adres+".html")).pack()
        return output

    LabelBilgi = Label(top20,text="Uniscan site hakkında dinamik, statik ve genel tarama yapar..\nuniscan -u www.example.com param\n Sonuçları /root/usr/share/uniscan/report dizinine kaydeder.\n Tarama +20dk sürebilir.",font=('Titillium', '10','bold')).place(x=30, y=20)



    ComboboxLabel = Label(top20, text="Tarama Tipi Sec:",font=('Titillium', '10','bold')).place(x=30, y=80)
    ComboboxEntry = ttk.Combobox(top20, width=22)
    ComboboxEntry['values'] = ('1 -d | Dinamik Tarama',
                               '2 -qweds | Genel Tarama',
                               '3 -s | Statik Tarama')

    ComboboxEntry.place(x=150, y=80)
    LabelGir = Label(top20, text="\nSite girin:",font=('Titillium', '10','bold')).place(x=30, y=100)
    mEntry = Entry(top20)
    mEntry.place(x=150, y=114)

    mbutton = Button(top20, text="Siteyi tara",font=('Titillium', '10','bold'), command=uniscanPlay)
    mbutton.place(x=30, y=150)

############################### kabakuvvet araclar ##############################################

def wordlistplay(minlen,maxlen,character,save):
    save ="/root/Desktop/" + save
    terminalcode = subprocess.Popen(["crunch",minlen,maxlen,character,"-o",save], stdout=subprocess.PIPE)
    output, err = terminalcode.communicate()
    return output

def wordlist():
    top1 = tkinter.Tk()
    top1.title("Word List Oluşturma")
    top1.geometry('550x350')
    uyari = Label(top1, text="Girilen karakter uzunluğu arasında ve karakterler ile WortList oluşturur.\nWordlist Desktop dizininde oluşacaktir.",font=('Titillium', '10','bold')).place(x=25, y=10)

    minlen = Label(top1, text="Min Karakter Sayısı",font=('Titillium', '10','bold')).place(x=25, y=50)
    minlenentry = Entry(top1, bd=1, width=25)
    minlenentry.place(x=25, y=70)

    maxlen = Label(top1, text="Max Karakter Sayısı",font=('Titillium', '10','bold')).place(x=25, y=90)
    maxlenentry = Entry(top1, bd=1, width=25)
    maxlenentry.place(x=25, y=110)

    character = Label(top1, text="İstenen Karakterler",font=('Titillium', '10','bold')).place(x=25, y=130)
    characterentry = Entry(top1, bd=1, width=25)
    characterentry.place(x=25, y=150)

    save = Label(top1, text="Dosya Adı",font=('Titillium', '10','bold')).place(x=25, y=170)
    saveentry = Entry(top1, bd=1, width=25)
    saveentry.place(x=25, y=190)

    mbutton = Button(top1, text="WordList Oluştur",font=('Titillium', '10','bold'), command=lambda : wordlistplay(minlenentry.get(),maxlenentry.get(),characterentry.get(),saveentry.get() )).place(x=25,y=230)

def mail():
    top5  = tkinter.Tk()
    top5.geometry('615x500')
    t = tk.Text(top5, height=15, width=77)
    t.place(x = 30 , y=250)

    s = tk.Scrollbar(top5)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def mailPlay(mailaddres,mailport,mailserver):
        t.insert(tk.END, "")
        terminalcode = subprocess.Popen(["hydra","-S","-l",mailaddres,"-P","/root/Desktop/wordlist","-v","-V","-e","ns","-s",mailport,mailserver,"smtp"], stdout=subprocess.PIPE)
   #hydra -S -l tezprojemail@gmail.com -P '/root/Desktop/wordlist' -v -V -e ns -s 465 smtp.gmail.com smtp
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        start = output.find("login:")
        finish = output.find("successfully")
        if finish!=-1:
            output= output[start:finish-14]
        else:
            output = "Giriş yapılamadı şifre listede olmayabilir ya da mail servisi korumalı olabilir."

        t.insert(tk.END, output)
        return output

    top5.title("Mail Şifre Kırıcı")

    uyari = Label(top5,
                  text="Mail adresinde 3. parti yazılımlara izin verildiyse borute-force saldırısı yapar.\n Mail smtp bilgilerine ihtiyaç vardır.\nŞifre listesi varsayılan olarak Desktop dizininden alinacaktir.\nİsmi wordlist olmaldır.",font=('Titillium', '10','bold')).place(x=25, y=15)
    mailaddres = Label(top5, text="Mail adresi girin:",font=('Titillium', '10','bold')).place(x=75, y=90)
    mailaddresenrty = Entry(top5)
    mailaddresenrty.place(x=75, y=105)

    mailport = Label(top5, text="Mail port no girin:",font=('Titillium', '10','bold')).place(x=75, y=130)
    mailport1 = Label(top5, text="465			465",font=('Titillium', '10','bold')).place(x=250, y=145)
    mailportentry = Entry(top5)
    mailportentry.place(x=75, y=145)

    mailserver = Label(top5, text="Mail server girin:",font=('Titillium', '10','bold')).place(x=75, y=170)
    mailserver1 = Label(top5, text="smtp.gmail.com	smtp.mail.yahoo.com",font=('Titillium', '10','bold')).place(x=250, y=185)
    mailserverentry = Entry(top5)
    mailserverentry.place(x=75, y=185)

    mbutton = Button(top5, text="Şifre Bul",font=('Titillium', '10','bold'),
                     command=lambda: mailPlay(mailaddresenrty.get(), mailportentry.get(), mailserverentry.get()))
    mbutton.place(x=75, y=210)

############################### diger araclar ##############################################


def tcptraceroute():
    top8 = tkinter.Tk()
    top8.geometry('780x440')
    top8.title("Hedef Sistem Yol Haritası -tcptraceroute-")
    t = tk.Text(top8, height=15, width=90)
    t.place(x = 30 , y=160)

    s = tk.Scrollbar(top8)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)
    def tcptraceroutePlay():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\\\\ \n")
        address = mEntry.get()
        terminalcode = subprocess.Popen(["tcptraceroute", address], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        #start = output.find("traceroute to")
        # finish= output.find("This query")-2
        #output = output[start:]
        #sonuc = Label(top8, text=output)
        #sonuc.pack()

        t.insert(tk.END, output)

        return output

    LabelBilgi = Label(top8,text="Hedef sisteme giden yol haritasini çıkarır. tcptraceroute  www.example.com\n",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top8, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=50)
    mEntry = Entry(top8)
    mEntry.place(x=150, y=50)

    mbutton = Button(top8, text="Yolu Bul",font=('Titillium', '10','bold'), command=tcptraceroutePlay)
    mbutton.place(x=300, y=50)


def wget():
    top10 = tkinter.Tk()
    top10.geometry('410x350')
    top10.title("Web Sitesi Dosyalarını İndir -httrack-")

    def wgetPlay():
        address = mEntry.get()
        terminalcode = subprocess.Popen(["httrack",address, "-O","/root/Desktop/Temp"], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        # start = output.find("")
        # finish= output.find("This query")-2
        # output = output[:finish]
        #sonuc = Label(top10,text=err)
        #sonuc.pack()


        labelframe = LabelFrame(top10, text="SONUCLAR",font=('Titillium', '10','bold'))
        labelframe.place(x=120, y=150)
        
        mbutton1 = Button(labelframe, text="Sonuçları Gör",font=('Titillium', '10','bold'), command=lambda:webbrowser.open_new_tab("/root/Desktop/Temp/index.html")).pack()

        left = Label(labelframe, text=err)
        left.pack()
        return output

    # www.notdefterim.pro
    # output boş dönüyor ama indiriyor. bildirim yazmadım

    LabelBilgi = Label(top10,text="Sitenin ulaşılabilir bütün dosyalarını indirir.\n\nhttrack www.example.com \n",font=('Titillium', '10','bold')).place(x=30, y=20)
    LabelGir = Label(top10, text="Site Adresi Girin:",font=('Titillium', '10','bold')).place(x=30, y=100)
    mEntry = Entry(top10)
    mEntry.place(x=150, y=100)

    mbutton = Button(top10, text="İndir",font=('Titillium', '10','bold'), command=wgetPlay)
    mbutton.place(x=300, y=95)

def macChange():
    top3 = tkinter.Tk()
    top3.title("Mac Adresi İşlemleri")
    top3.geometry('460x290')

    tabControl2 = ttk.Notebook(top3)

    macbul = ttk.Frame(tabControl2)
    tabControl2.add(macbul, text="MAC Bul")

    tabControl2.pack(expan="1", fill="both")

    random = ttk.Frame(tabControl2)
    tabControl2.add(random, text="Rastgele Mac Değiştir")

    newmac = ttk.Frame(tabControl2)
    tabControl2.add(newmac, text="Yeni Mac Adresi Gir")

    t = tk.Text(random, height=10, width=55)
    t.place(x = 30 , y=90)

    s = tk.Scrollbar(random)
    t.config(yscrollcommand=s.set)
    s.pack(side=tk.RIGHT, fill=tk.Y)
    s.config(command=t.yview)

    t3 = tk.Text(newmac, height=10, width=55)
    t3.place(x = 30 , y=120)

    s3 = tk.Scrollbar(newmac)
    t3.config(yscrollcommand=s3.set)
    s3.pack(side=tk.RIGHT, fill=tk.Y)
    s3.config(command=t3.yview)



    t2 = tk.Text(macbul, height=10, width=55)
    t2.place(x = 30 , y=90)

    s2 = tk.Scrollbar(macbul)
    t2.config(yscrollcommand=s2.set)
    s2.pack(side=tk.RIGHT, fill=tk.Y)
    s2.config(command=t2.yview)

    def macquery():## hatalı tip hatası veriyor.
        t2.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\ \n")
        terminalcode = subprocess.Popen(["ifconfig"], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        start = output.find("ether")+5
        finish = output.find("tx")
        output = output[start:finish]
        t2.insert(tk.END, "MAC Adresiniz: \n")
        t2.insert(tk.END, output)
        t2.insert(tk.END, "\n")
        return output


    def macchangerand():
        t.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\ \n")
        terminalcode = subprocess.Popen(["sudo","macchanger","-r","eth0"], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output =str(output,'utf-8')
        t.insert(tk.END, output)
        return output

    def macchangemanual(newmac):
        t3.insert(tk.END, "\\\\\\\\\\\\\\\\\\\\\\\ \n")
        terminalcode = subprocess.Popen(["sudo","macchanger","-m",newmac,"eth0"], stdout=subprocess.PIPE)
        output, err = terminalcode.communicate()
        output = str(output,'utf-8')
        t3.insert(tk.END, output)
        return output

    text = Label(macbul, text="\nMac adresinizi Öğrenin\n",font=('Titillium', '10','bold')).pack()
    mbutton1 = Button(macbul, text="Mac Adresini Bul",font=('Titillium', '10','bold'), command=macquery).pack()

    text = Label(random, text="\nMac Adresinizi rastgele değiştirin\n",font=('Titillium', '10','bold')).pack()
    mbutton2 = Button(random, text="Mac Değiştir",font=('Titillium', '10','bold'), command=macchangerand).pack()

    text1 = Label(newmac, text="\nMac Adresinizi Manuel değiştirin\n",font=('Titillium', '10','bold')).pack()
    text = Label(newmac, text="Yeni Mac Adresinizi Girin:",font=('Titillium', '10','bold')).pack()
    mEntry1 = Entry(newmac)
    mEntry1.pack()
    mbutton3 = Button(newmac, text="Mac Değiştir",font=('Titillium', '10','bold'), command=lambda: macchangemanual(mEntry1.get() )).pack()

def dene2():
    tkdene2 = tkinter.Tk()
    tkdene2.geometry('300x300')

    InputLabel = Label(tkdene2, text="InputLabel").place(x=10, y=10)
    InputEntry = Entry(tkdene2, bd=1, width=25).place(x=100, y=10)

    ComboboxLabel = Label(tkdene2, text="tool2").place(x=10, y=50)
    ComboboxEntry = ttk.Combobox(tkdene2, width=22)
    ComboboxEntry['values'] = ('option3', 'option4', 'option5')
    ComboboxEntry.place(x=100, y=50)

top = tkinter.Tk()
top.geometry('720x350')
top.title("ARAYUZ")

tabControl = ttk.Notebook(top)

bilgiToplama = ttk.Frame(tabControl)
tabControl.add(bilgiToplama, text="BILGI TOPLAMA ARACLARI")

tabControl2 = ttk.Notebook(bilgiToplama)

pasifBilgiToplama = ttk.Frame(tabControl2)
tabControl2.add(pasifBilgiToplama,text="PASIF BILGI TOPLAMA ")

aktifBilgiToplama = ttk.Frame(tabControl2)
tabControl2.add(aktifBilgiToplama,text="AKTIF BILGI TOPLAMA ")

portServis = ttk.Frame(tabControl2)
tabControl2.add(portServis,text="PORT VE SERVİS TARAMA ")

tabControl2.pack(expan="1",fill="both")


webGuvenligi = ttk.Frame(tabControl)
tabControl.add(webGuvenligi, text="WEB GUVENLIGI ARACLARI")


kabaKuvvet = ttk.Frame(tabControl)
tabControl.add(kabaKuvvet, text="KABA KUVVET ARACLARI")

digerAraclar = ttk.Frame(tabControl)
tabControl.add(digerAraclar, text="DIGER ARACLAR")



tabControl.pack(expan = 1 , fill = "both")

############################### pasif bilgi toplama ########################################

site1 = Label(pasifBilgiToplama, text="\n1996’dan sonraki birçok web sitesi arşivine buradan ulaşaılabilir.\n",font=('Titillium', '10','bold')).place(x = 160, y = 15)
mbutton = Button(pasifBilgiToplama, text="www.archive.org", command=lambda:webbrowser.open_new_tab("www.archive.org")).place(x = 15, y = 28)

site3 = Label(pasifBilgiToplama, text="\nIP adresinin coğrafi konumunu belirllemek için kullanılır.\n",font=('Titillium', '10','bold')).place(x = 160, y = 65)
link3 = Button(pasifBilgiToplama, text = "www.iplocation.net", command=lambda:webbrowser.open_new_tab("www.iplocation.net")).place(x = 15, y = 78)

site4 = Label(pasifBilgiToplama, text="\nWhois, DNS ve bir çok sorgunun yapılabileceği ticari bir kaynaktır.\n",font=('Titillium', '10','bold')).place(x = 160, y = 115)
link4 = Button(pasifBilgiToplama, text = "www.dnsstuff.com", command=lambda:webbrowser.open_new_tab("www.dnsstuff.com")).place(x = 15, y = 128)

site5 = Label(pasifBilgiToplama, text="\nBir ip adresi üzerinde çalışan web sayfalarının listesini verebilmektedir.\n",font=('Titillium', '10','bold')).place(x = 160, y = 165)
link5 = Button(pasifBilgiToplama, text = "www.robtex.com", command=lambda:webbrowser.open_new_tab("www.robtex.com")).place(x = 15, y = 178)

site2 = Label(pasifBilgiToplama, text="\nIp adresinin ya da alan adının barındırdığı işletim sistemi,\n çekirdek versiyonu web servislerini görebilirsiniz.\n",font=('Titillium', '10','bold')).place(x = 160, y = 215)
link2 = Button(pasifBilgiToplama, text = "www.netcraft.com", command=lambda:webbrowser.open_new_tab("www.netcraft.com")).place(x = 15, y = 228)



############################### aktif bilgi toplama ########################################

nslookupp = Button(aktifBilgiToplama, text = "Site IP Adresi", command = nslookup, width="16",font=('Titillium', '10','bold')).place(x = 10, y = 15)
LabelGir1 = Label(aktifBilgiToplama, text="Nslookup domain ip aralığını araştırır.", font=('Titillium', '10', 'bold')).place(x=200, y=17)

urlcrazyy = Button(aktifBilgiToplama, text = "Benzer Domain", command = urlcrazy, width="16",font=('Titillium', '10','bold')).place(x = 10, y = 65)
LabelGir2 = Label(aktifBilgiToplama, text="URLcrazy  hedefe benzer domainleri ve kullanım durumlarını listeler.", font=('Titillium', '10', 'bold')).place(x=200, y=67)

# whatwebb = Button(aktifBilgiToplama,text="Site Script",command=whatweb,width="16",font=('Titillium', '10','bold')).place(x=10,y=75)

dnsenumm = Button(aktifBilgiToplama,text="DNS Bilgileri",command=dnsenum,width="16",font=('Titillium', '10','bold')).place(x=10,y=115)
LabelGir3 = Label(aktifBilgiToplama, text="Hedef sunucu veya site dnsleri hakkında bilgi verir.", font=('Titillium', '10', 'bold')).place(x=200, y=117)

# fiercee = Button(aktifBilgiToplama,text="Version Bilgisi",command=fierce,width="16",font=('Titillium', '10','bold')).place(x=10,y=135)


dmitryAktiff = Button(aktifBilgiToplama,text="Açık Port ve Whois",command=dmitry,width="16",font=('Titillium', '10','bold')).place(x=10,y=165)
LabelGir4 = Label(aktifBilgiToplama, text="Dmitry aracı whois bilgileri ve port taraması yapar.", font=('Titillium', '10', 'bold')).place(x=200, y=167)

#########################port ve servis taramaları ######################################

nmapAg = Button(portServis, text = "Ağdaki Cihazlar", command = nmapAg, width="20",font=('Titillium', '10','bold')).place(x = 10, y = 15)
LabelGir5 = Label(portServis, text="Ağdaki aktif cihazları tara.", font=('Titillium', '10', 'bold')).place(x=200, y=17)

cokluTarama = Button(portServis,text="Çoklu Tarama",command=nmapCoklu,width="20",font=('Titillium', '10','bold')).place(x=10,y=65)
LabelGir6 = Label(portServis, text="Genel internet sitesi taramaları.", font=('Titillium', '10', 'bold')).place(x=200, y=67)

firewallAtlat = Button(portServis,text="Güvenlik Duvarı Atlat",command=nmapfirewall,width="20",font=('Titillium', '10','bold')).place(x=10, y=115)
LabelGir7 = Label(portServis, text="Güvenlik duvarı var ise atlatarak tarama yapın.", font=('Titillium', '10', 'bold')).place(x=200, y=117)

############################### web güvenliği #############################################

firewallControll = Button(webGuvenligi, text = "Güvenlik Duvarı Kontrolü", command = firewallControl, width="22",font=('Titillium', '10','bold')).place(x = 10, y = 15)
LabelGir9 = Label(webGuvenligi, text="Sitenin güvenlik duvarı hakkında bilgi verir", font=('Titillium', '10', 'bold')).place(x=230, y=17)

skipfishh = Button(webGuvenligi,text="Detaylı Site Tarama",command=skipfish,width="22",font=('Titillium', '10','bold')).place(x=10,y=65)
LabelGir10 = Label(webGuvenligi, text="Siteyi genel hatları ile tarayıp bulduğu açıkları raporlar.", font=('Titillium', '10', 'bold')).place(x=230, y=68)

uniscan = Button(webGuvenligi,text="Site Tarama Raporlama",command=uniscan,width="22",font=('Titillium', '10','bold')).place(x=10,y=115)
LabelGir11 = Label(webGuvenligi, text="Siteyi detaylı tarayıp bulduğu açıkları raporlar.", font=('Titillium', '10', 'bold')).place(x=230, y=117)


############################### kabakuvvet araclar ##############################################

wordlisttk = Button(kabaKuvvet, text = "WordList Oluştur", command = wordlist, width="14",font=('Titillium', '10','bold')).place(x = 10, y = 15)
LabelGir12 = Label(kabaKuvvet, text="Girilen karakter uzunluğu arasında ve karakterler ile WortList oluşturur.", font=('Titillium', '10', 'bold')).place(x=200, y=17)

mailCracker = Button(kabaKuvvet, text = "Mail Şifre Bul", command = mail, width="14",font=('Titillium', '10','bold')).place(x = 10, y = 65)
LabelGir13 = Label(kabaKuvvet, text="Mail adresine BuruteForce saldırısı yapar.", font=('Titillium', '10', 'bold')).place(x=200, y=67)


############################### diger araclar ##############################################

tcptraceroutee = Button(digerAraclar, text = "Hedef Yol Haritası", command = tcptraceroute, width="16",font=('Titillium', '10','bold')).place(x = 10, y = 15)
LabelGir14 = Label(digerAraclar, text="Hedef sisteme giden yol haritasini çıkarır.", font=('Titillium', '10', 'bold')).place(x=200, y=17)

wgett = Button(digerAraclar, text = "Web Template Indir", command = wget, width="16",font=('Titillium', '10','bold')).place(x = 10, y = 65)
LabelGir15 = Label(digerAraclar, text="Sitenin ulaşılabilir bütün dosyalarını indirir", font=('Titillium', '10', 'bold')).place(x=200, y=67)

macChanger = Button(digerAraclar, text = "MAC Adresi Değiştir", command = macChange, width="16",font=('Titillium', '10','bold')).place(x = 10, y = 115)
LabelGir16 = Label(digerAraclar, text="Mac adresi değiştirme işlemlerini yapar..", font=('Titillium', '10', 'bold')).place(x=200, y=117)


top.mainloop()
